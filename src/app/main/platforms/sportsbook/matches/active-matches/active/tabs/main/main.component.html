
<div class="container">
  <div class="content-action">
    <div class="title"><a [routerLink]="['../../../all-active']">{{'Sport.ActiveMatches' | translate}}</a> /
      {{MatchId}} : {{'Sport.Match' | translate}} {{this.matchName}} </div>
      
      <div class="partner-dropdown">
        <mat-select
        (selectionChange)="onPartnerChange($event.value)"
        placeholder="{{'Partners.SelectPartner' | translate}}"
        panelClass="overlay-dropdown"
        disableOptionCentering>
        <mat-option [value]="null">{{'Partners.SelectPartner' | translate}}</mat-option>
        <mat-option *ngFor="let partner of partners" [value]="partner.Id">{{partner.Name}}</mat-option>
      </mat-select>
    </div>
    
    <button mat-stroked-button class="mat-btn" (click)="onResetMatch()">{{'Sport.ResetMatch' | translate}}</button>
    <button mat-stroked-button class="edit-btn" (click)="isEdit = !isEdit">{{'Common.Edit' | translate}}</button>
    
  </div>

  <div class="content-edit">
    <form class="grid-edit" [class.can-edit]="isEdit" [formGroup]="formGroup">

      <div>
        <div class="first-hand">{{'Clients.Id' | translate}}</div>
        <div class="second-hand">{{activeMatch.MatchId}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Common.Id' | translate" readonly [formControlName]="'MatchId'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.SportName' | translate}}</div>
        <div class="second-hand">{{activeMatch.SportName}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Sport.SportName' | translate" readonly [formControlName]="'SportName'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.Number' | translate}}</div>
        <div class="second-hand">{{activeMatch.Number}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Sport.Number' | translate" readonly [formControlName]="'Number'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.RegionName' | translate}}</div>
        <div class="second-hand">{{activeMatch.RegionName}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Sport.RegionName' | translate" readonly [formControlName]="'RegionName'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Products.ExternalId' | translate}}</div>
        <div class="second-hand">{{activeMatch.ExternalId}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Products.ExternalId' | translate" readonly [formControlName]="'ExternalId'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.CompetitionName' | translate}}</div>
        <div class="second-hand">{{activeMatch.CompetitionName}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Sport.RegionName' | translate" readonly [formControlName]="'CompetitionName'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Clients.StartTime' | translate}}</div>
        <div class="second-hand">{{activeMatch.StartTime}}</div>
        <div class="form-field form-calendar">
          <div class="calendar-picker start">
            <app-date-time-picker formControlName="StartTime"></app-date-time-picker>
          </div>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.Competition' | translate}}</div>
        <div class="second-hand">{{activeMatch.CompetitionId}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.Competition' | translate" [formControlName]="'CompetitionId'">
            <mat-error *ngIf="errorControl['CompetitionId']?.touched && errorControl['CompetitionId'].errors?.required">
              {{'Sport.Competition' | translate}} {{'Errors.Required' | translate}}
            </mat-error>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.AbsoluteLimit' | translate}}</div>
        <div class="second-hand">{{activeMatch.AbsoluteLimit}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.AbsoluteLimit' | translate"
            [formControlName]="'AbsoluteLimit'">
            <mat-error *ngIf="errorControl['AbsoluteLimit']?.touched && errorControl['AbsoluteLimit'].errors?.required">
              {{'Sport.AbsoluteLimit' | translate}} {{'Errors.Required' | translate}}
            </mat-error>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.Delay' | translate}}</div>
        <div class="second-hand">{{activeMatch.Delay}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.Delay' | translate" [formControlName]="'Delay'">
            <mat-error *ngIf="errorControl['Delay']?.touched && errorControl['Delay'].errors?.required">
              {{'Sport.Delay' | translate}} {{'Errors.Required' | translate}}
            </mat-error>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.MaxWinPrematchSingle' | translate}}</div>
        <div class="second-hand">{{activeMatch.MaxWinPrematchSingle}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.MaxWinPrematchSingle' | translate"
                   [formControlName]="'MaxWinPrematchSingle'">
            <mat-error
              *ngIf="errorControl['MaxWinPrematchSingle']?.touched && errorControl['MaxWinPrematchSingle'].errors?.required">
              {{'Sport.MaxWinPrematchSingle' | translate}} {{'Errors.Required' | translate}}
            </mat-error>
        </div>
      </div>


      <div>
        <div class="first-hand">{{'Sport.MaxWinPrematchMultiple' | translate}}</div>
        <div class="second-hand">{{activeMatch.MaxWinPrematchMultiple}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.MaxWinPrematchMultiple' | translate"
                   [formControlName]="'MaxWinPrematchMultiple'">
            <mat-error
              *ngIf="errorControl['MaxWinPrematchMultiple']?.touched && errorControl['MaxWinPrematchMultiple'].errors?.required">
              {{'Sport.MaxWinPrematchMultiple' | translate}} {{'Errors.Required' | translate}}
            </mat-error>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.MaxWinLiveSingle' | translate}}</div>
        <div class="second-hand">{{activeMatch.MaxWinLiveSingle}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.MaxWinLiveSingle' | translate"
                   [formControlName]="'MaxWinLiveSingle'">
            <mat-error *ngIf="errorControl['MaxWinLiveSingle']?.touched && errorControl['MaxWinLiveSingle'].errors?.required">
              {{'Sport.MaxWinLiveSingle' | translate}} {{'Errors.Required' | translate}}
            </mat-error>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.MaxWinLiveMultiple' | translate}}</div>
        <div class="second-hand">{{activeMatch.MaxWinLiveMultiple}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.MaxWinLiveMultiple' | translate"
                   [formControlName]="'MaxWinLiveMultiple'">
            <mat-error
              *ngIf="errorControl['MaxWinLiveMultiple']?.touched && errorControl['MaxWinLiveMultiple'].errors?.required">
              {{'Sport.MaxWinLiveMultiple' | translate}} {{'Errors.Required' | translate}}
            </mat-error>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.ResultInfo' | translate}}</div>
        <div class="second-hand">{{activeMatch.ResultInfo}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Sport.ResultInfo' | translate" readonly
                   [formControlName]="'ResultInfo'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Common.Type' | translate}}</div>
        <div class="second-hand">{{activeMatch.Type}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [placeholder]="'Common.Type' | translate" [formControlName]="'Type'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Dashboard.Provider' | translate}}</div>
        <div class="second-hand">{{activeMatch.ProviderName}}</div>
        <div class="form-field form-dropdown">
            <mat-select [formControlName]="'ProviderId'" #pr (selectionChange)="updateProviders(pr.value)">
              <mat-option *ngFor="let Provider of Providers" [value]="Provider.Id">{{Provider.Name}}</mat-option>
            </mat-select>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Common.Status' | translate}}</div>
        <div class="second-hand">{{activeMatch.StatusName}}</div>
        <div class="form-field form-dropdown">
          <mat-select [formControlName]="'Status'">
            <mat-option *ngFor="let status of Statuses" [value]="status.status">{{status.name}}</mat-option>
          </mat-select>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.CurrentPhase' | translate}}</div>
        <div class="second-hand">{{activeMatch.currentPhase}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Sport.CurrentPhase' | translate" readonly [formControlName]="'currentPhase'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.LinkedMatches' | translate}}</div>
        <div class="second-hand">{{activeMatch.LinkedMatches}}</div>
        <div class="form-field form-input">
            <input matInput [placeholder]="'Sport.LinkedMatches' | translate" readonly [formControlName]="'LinkedMatches'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Common.State' | translate}}</div>
        <div class="second-hand">{{activeMatch.Enabled}}</div>
        <div class="form-field form-checkbox">
          <mat-slide-toggle labelPosition="before" color="primary" [formControlName]="'Enabled'" (change)="onSubmit()" >{{'Common.State' | translate}}</mat-slide-toggle>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.FeedState' | translate}}</div>
        <div class="static-hand">{{!activeMatch.BlockedByFeed}}</div>
      </div>

      <div>
        <div class="first-hand">{{'Sport.AutoSettlement' | translate}}</div>
        <div class="second-hand">{{activeMatch.AutoSettlementName}}</div>
        <div class="form-field form-dropdown">
            <mat-select [formControlName]="'AutoSettlement'" placeholder="{{'None'}}">
              <mat-option 
                *ngFor="let status of settlementStatuses" 
                  [value]="status.Id">
                  {{status.Name}}
              </mat-option>
            </mat-select>
        </div>
      </div>




      <div class="form-actions">
        <div class="actions"  class="actions" *ngIf="isEdit">
          <button mat-stroked-button class="mat-cancel-btn" (click)="isEdit = false">{{'Common.Cancel' | translate}}</button>
          <button mat-stroked-button class="mat-btn" type="submit" (click)="onSubmit()">{{'Common.Save' |
            translate}}</button>
        </div>
      </div>
    </form>

    <div class="title">{{'Sport.Competitors' | translate}}</div>

    <div class="grid-content">
      <ag-grid-angular
        #agGrid class="ag-theme-balham"
        [headerHeight]="33" [rowHeight]="42"
        [rowData]="rowData"
        [suppressCopyRowsToClipboard]="true"
        [rowModelType]="rowModelType"
        [columnDefs]="columnDefs"
        [defaultColDef]="defaultColDef"
        [cacheBlockSize]="cacheBlockSize"
        (gridReady)="onGridReady($event)"
        [ensureDomOrder]="true"
        [enableCellTextSelection]="true"
        [components]="frameworkComponents"
        [getContextMenuItems]="getContextMenuItems"
        rowSelection="single">
      </ag-grid-angular>
    </div>

  </div>

  <div class="content-action left">
    <button mat-raised-button class="mat-btn" (click)="onAddCompetitor()">{{'Common.Add' | translate}}</button>
  </div>
</div>

