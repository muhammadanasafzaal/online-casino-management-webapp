<div class="container">
  <div class="content-action">
    <div class="title"><a [routerLink]="['../../commonses']">{{'Bonuses.Commons' | translate}}</a> /: {{commonId}}</div>
    <button mat-stroked-button class="edit-btn" (click)="isEdit = true">{{'Common.Edit' | translate}}</button>
  </div>

  <div class="content-edit">
    <form class="grid-edit" [class.can-edit]="isEdit" [formGroup]="formGroup">
      <div>
        <div class="first-hand">{{'Common.Id' | translate}}</div>
        <div class="second-hand">{{commonSettings?.Id}}</div>
        <div class="form-field form-input">
            <input matInput [formControlName]="'Id'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Common.State' | translate}}</div>
        <div class="second-hand">{{ status[commonSettings?.Status - 1]?.Name}}</div>
        <div class="form-field form-dropdown">
          <mat-select
          [formControlName]="'Status'">
          @for (state of status; track $index) {
            <mat-option [value]="state.Id">{{state.Name}}</mat-option>
          }
        </mat-select>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Common.WinAccountTypeId' | translate}}</div>
        <div class="second-hand">{{ clientType[commonSettings?.WinAccountTypeId - 1]?.Name}}</div>
        <div class="form-field form-dropdown">
          <mat-select
          [formControlName]="'WinAccountTypeId'">
          @for (type of clientType; track $index) {
            <mat-option [value]="type.Id">{{type.Name}}</mat-option>
          }
        </mat-select>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Common.Name' | translate}}</div>
        <div class="second-hand">{{commonSettings?.Name}}</div>
        <div class="form-field form-input">
            <input matInput [formControlName]="'Name'">
        </div>
      </div>

      @if (commonSettings?.BonusTypeId >= 10 && commonSettings?.BonusTypeId <= 14) {
        <div>
          <div class="first-hand">{{'Bonuses.ResetOnWithdraw' | translate}}</div>
          <div class="second-hand">{{commonSettings?.ResetOnWithdraw}}</div>
          <div class="form-field form-checkbox">
            <mat-checkbox [formControlName]="'ResetOnWithdraw'">{{'Bonuses.ResetOnWithdraw' | translate}}</mat-checkbox>
          </div>
        </div>
      }

      <div>
        <div class="first-hand">{{'Partners.PartnerName' | translate}}</div>
        <div class="second-hand">{{commonSettings?.PartnerName}}</div>
        <div class="form-field form-input">
            <input matInput [formControlName]="'PartnerName'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.BonusWinMinAmount' | translate}}</div>
        <div class="second-hand">{{commonSettings?.MinAmount}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'MinAmount'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.AccountType' | translate}}</div>
        <div class="second-hand">{{accounttypeName}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'AccountTypeId'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.BonusWinMaxAmount' | translate}}</div>
        <div class="second-hand">{{commonSettings?.MaxAmount}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'MaxAmount'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.Priority' | translate}}</div>
        <div class="second-hand">{{commonSettings?.Priority}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'Priority'">
        </div>
      </div>

      @if (commonSettings?.BonusTypeId == 10 || commonSettings?.BonusTypeId == 13) {
        <div>
          <div class="first-hand">{{'Bonuses.LinkedCampaign' | translate}}</div>
          <div class="second-hand">{{commonSettings?.LinkedCampaign}}</div>
          <div class="form-field form-checkbox">
            <mat-checkbox [formControlName]="'LinkedCampaign'">{{'Bonuses.LinkedCampaign' | translate}}</mat-checkbox>
          </div>
        </div>
      }

      @if (commonSettings?.BonusTypeId == 1 || commonSettings?.BonusTypeId == 3) {
        <div>
          <div class="first-hand">{{'Bonuses.PeriodInHours' | translate}}</div>
          <div class="second-hand">{{commonSettings?.Period}}</div>
          <div class="form-field form-input">
              <input matInput type="number" [formControlName]="'Period'">
          </div>
        </div>
      }

      @if (commonSettings?.BonusTypeId == 1 || commonSettings?.BonusTypeId == 3) {
        <div >
          <div class="first-hand">{{'Bonuses.Percent' | translate}}</div>
          <div class="second-hand">{{commonSettings?.Percent}}</div>
          <div class="form-field form-input">
              <input matInput type="number" [formControlName]="'Percent'">
          </div>
        </div>
      }

      <div>
        <div class="first-hand">{{'Bonuses.StartTime' | translate}}</div>
        <div class="second-hand">{{commonSettings?.StartTime | date:'dd/MM/yyyy HH:mm' }}</div>
        <div class="form-field form-calendar calendar-picker">
            <input matInput type="datetime-local" #dropdownEndContent class="data-time-picker" [formControlName]="'StartTime'"
              name="meeting-time" >
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.FinishTime' | translate}}</div>
        <div class="second-hand">{{commonSettings?.FinishTime | date:'dd/MM/yyyy HH:mm'}}</div>
        <div class="form-field form-calendar calendar-picker">
              <input matInput type="datetime-local" #dropdownContent class="data-time-picker" [formControlName]="'FinishTime'"
                name="meeting-time" >
        </div>
      </div>

      @if (commonSettings?.BonusTypeId >= 10 && commonSettings?.BonusTypeId <= 14) {
        <div >
          <div class="first-hand">{{'Bonuses.ValidForAwardingInHours' | translate}}</div>
          <div class="second-hand">{{commonSettings?.ValidForAwarding}}</div>
          <div class="form-field form-input">
              <input matInput type="number" [formControlName]="'ValidForAwarding'">
          </div>
        </div>
      }

      <div>
        <div class="first-hand">{{'Type' | translate}}</div>
        <div class="second-hand">{{commonSettings?.BonusTypeName}}</div>
        <div class="form-field form-input">
            <input matInput type="text" [value]="commonSettings?.BonusTypeName" readonly>
        </div>
      </div>

      @if (commonSettings?.BonusTypeId >= 10 && commonSettings?.BonusTypeId <= 14) {
        <div >
          <div class="first-hand">{{'Bonuses.ValidForSpendingInHours' | translate}}</div>
          <div class="second-hand">{{commonSettings?.ValidForSpending}}</div>
          <div class="form-field form-input">
              <input matInput type="number" [formControlName]="'ValidForSpending'">
          </div>
        </div>
      }

      <div>
        <div class="first-hand">{{'Bonuses.Sequence' | translate}}</div>
        <div class="second-hand">{{commonSettings?.Sequence}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'Sequence'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.ReusingMaxCount' | translate}}</div>
        <div class="second-hand">{{commonSettings?.ReusingMaxCount}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'ReusingMaxCount'">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.MaxGranted' | translate}}</div>
        <div class="second-hand">{{commonSettings?.MaxGranted}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'MaxGranted'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.TurnoverCount' | translate}}</div>
        <div class="second-hand">{{commonSettings?.TurnoverCount}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'TurnoverCount'" [readonly]="this.commonSettings?.BonusTypeId != 13 && this.commonSettings?.BonusTypeId != 10  ">
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.MaxReceiversCount' | translate}}</div>
        <div class="second-hand">{{commonSettings?.MaxReceiversCount}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'MaxReceiversCount'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.TotalGranted' | translate}}</div>
        <div class="second-hand">{{commonSettings?.TotalGranted}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'TotalGranted'" readonly>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.TotalReceiversCount' | translate}}</div>
        <div class="second-hand">{{commonSettings?.TotalReceiversCount}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'TotalReceiversCount'" readonly>
        </div>
      </div>

      @if (commonSettings?.BonusTypeId === 10 || commonSettings?.BonusTypeId === 13) {
        <div>
          <div class="first-hand">{{'Bonuses.PercentFromBonusAmount' | translate}}</div>
          <div class="second-hand">{{commonSettings?.Percent}}</div>
          <div class="form-field form-input">
              <input matInput type="number" [formControlName]="'Percent'">
          </div>
        </div>
      }

      <div>
        <div class="first-hand">{{'Bonuses.LinkedBonusId' | translate}}</div>
        <div class="second-hand">{{commonSettings?.LinkedBonusId}}</div>
        <div class="form-field form-input">
            <input matInput type="number" [formControlName]="'LinkedBonusId'">
        </div>
      </div>

      @if (commonSettings?.BonusTypeId === 10 || commonSettings?.BonusTypeId === 13) {
        <div>
          <div class="first-hand">{{'Bonuses.FreezeBonusBalance' | translate}}</div>
          <div class="second-hand">{{commonSettings?.FreezeBonusBalance}}</div>
          <div class="form-field form-checkbox">
            <mat-checkbox [formControlName]="'FreezeBonusBalance'">{{'Bonuses.FreezeBonusBalance' |
              translate}}</mat-checkbox>
          </div>
        </div>
      }
      
      @if (bonusTypeId == 10 ||  bonusTypeId == 13 ||  bonusTypeId == 11 ||  bonusTypeId == 12 ||  bonusTypeId == 14) {
        <div >
          <div class="first-hand">{{'Bonuses.Regularity' | translate}}</div>
          <div class="second-hand" >{{regularitys[commonSettings?.Regularity]?.Name}}</div>
          <div class="form-field form-dropdown">
            <mat-select [formControlName]="'Regularity'">
              @for (regularity of regularitys; track $index) {
                <mat-option [value]="regularity.Id">{{regularity.Name}}</mat-option>
              }
            </mat-select>
          </div>
        </div>
      }

      @if(bonusTypeId == 10 ||  bonusTypeId == 13 ||  bonusTypeId == 11 ||  bonusTypeId == 12 ||  bonusTypeId == 14) {
        <div>
          <div class="first-hand">{{'Bonuses.DayOfWeek' | translate}}</div>
          <div class="second-hand">{{days[commonSettings?.DayOfWeek]?.Name}}</div>
          <div class="form-field form-dropdown">
            <mat-select [formControlName]="'DayOfWeek'">
              @for (day of days; track $index) {
                <mat-option [value]="day.Id">{{day.Name}}</mat-option>
              }
            </mat-select>
          </div>
        </div>
      }

      @if (bonusTypeId == 10 ||  bonusTypeId == 13 ||  bonusTypeId == 11 ||  bonusTypeId == 12 ||  bonusTypeId == 14) {
        <div>
          <div class="first-hand">{{'Bonuses.ReusingMaxCountInPeriod' | translate}}</div>
          <div class="second-hand">{{commonSettings?.ReusingMaxCountInPeriod}}</div>
          <div class="form-field form-input">
              <input matInput type="number" [formControlName]="'ReusingMaxCountInPeriod'">
          </div>
        </div>
      }

      @if (commonSettings?.BonusTypeId == 12) {
        <div>
          <div class="first-hand">{{'Bonuses.AllowSplit' | translate}}</div>
          <div class="second-hand">{{commonSettings?.AllowSplit}}</div>
          <div class="form-field form-checkbox">
            <mat-checkbox [formControlName]="'AllowSplit'">{{'Bonuses.AllowSplit' | translate}}</mat-checkbox>
          </div>
        </div>
      }

      @if (commonSettings?.BonusTypeId == 12) {
        <div >
          <div class="first-hand">{{'Bonuses.RefundRollbacked' | translate}}</div>
          <div class="second-hand">{{commonSettings?.RefundRollbacked}}</div>
          <div class="form-field form-checkbox">
            <mat-checkbox [formControlName]="'RefundRollbacked'">{{'Bonuses.RefundRollbacked' | translate}}</mat-checkbox>
          </div>
        </div>
      }

      @if (bonusTypeId != 1 && bonusTypeId != 14 && bonusTypeId != 12) {
        <div></div>
      }
      

      <div>
        <div class="first-hand">{{'Bonuses.ChooseCountries' | translate}}</div>
        <div class="second-hand">
          <span class="second-left"> 
            @if (commonSettings?.Countries?.Type==1) {
              {{'Bonuses.InSet' | translate}}
            } @else if (commonSettings?.Countries?.Type==2) {
              {{'Bonuses.OutOfSet' | translate}}
            }
          </span>
          <span class="second-right">
            @for (country of countriesEntites; track $index) {
              {{country}}
            }
          </span>
        </div>

        <div class="form-field group-field" [formGroupName]="'Countries'">
          <div class="group-left-item">
            <input [value]="1" [formControlName]="'Type'" type="radio">{{'Bonuses.InSet' | translate}}
            <input [value]="2" style="margin-left: 5px;" [formControlName]="'Type'" type="radio">{{'Bonuses.OutOfSet' |
            translate}}
          </div>

          <div class="group-right-item">
            <mat-select [formControlName]="'Ids'" multiple>
              @for (country of countries; track $index) {
                <mat-option [value]="country.Id">{{country.Name}}</mat-option>
              }
            </mat-select>
          </div>

        </div>
      </div>

      <div  >
        <div class="first-hand">{{'Bonuses.ChooseLanguages' | translate}}</div>
        <div class="second-hand">
          <span class="second-left"> 
            @if (commonSettings?.Languages?.Type==1) {
              {{'Bonuses.InSet' | translate}}
            } @else if (commonSettings?.Languages?.Type==2) {

              {{'Bonuses.OutOfSet' | translate}}
            }
          </span>

            <span class="second-right">
              @for ( language of languageEntites; track $index) {
                {{languageEntites}}
              }
            </span>
        </div>


        <div class="form-field group-field" [formGroupName]="'Languages'">
          <div class="group-left-item">
          <input [value]="1" [formControlName]="'Type'" type="radio">{{'Bonuses.InSet' | translate}}
          <input [value]="2" style="margin-left: 5px;" [formControlName]="'Type'" type="radio">{{'Bonuses.OutOfSet' |
          translate}}
          </div>

          <div class="group-right-item">
            <mat-select [formControlName]="'Names'" multiple>
              @for (language of languages; track $index) {
                <mat-option [value]="language.Id" >{{language.Name}}</mat-option>
              }
            </mat-select>
          </div>
        </div>
      </div>

      <div>
        <div class="first-hand">{{'Bonuses.ChooseSegment' | translate}}</div>
        <div class="second-hand" >
          <span class="second-left"> 
            @if (commonSettings?.SegmentIds?.Type==1) {
              {{'Bonuses.InSet' | translate}}
            } @else if (commonSettings?.SegmentIds?.Type==2) {
              {{'Bonuses.OutOfSet' | translate}}
            }
          </span>

          <span class="second-right">
            @for (item of segmentesEntites; track $index) {
              {{item}}
            }
          </span>
        </div>


        <div class="form-field group-field" [formGroupName]="'SegmentIds'">
          <div class="group-left-item">
          <input [value]="1" [formControlName]="'Type'" type="radio">{{'Bonuses.InSet' | translate}}
          <input [value]="2" style="margin-left: 5px;" [formControlName]="'Type'" type="radio">{{'Bonuses.OutOfSet' |
          translate}}
          </div>
          
          <div class="group-right-item">
            <mat-select [formControlName]="'Ids'" multiple>
              @for (segment of segments; track $index) {
                <mat-option [value]="segment.Id">{{segment.Name}}</mat-option>
              }
            </mat-select>
          </div>

        </div>
      </div>


      <div>
        <div class="first-hand">{{'Bonuses.ChooseCurrency' | translate}}</div>
        <div class="second-hand">
          <span class="second-left"> 
            @if (commonSettings?.Currencies?.Type==1) {
              {{'Bonuses.InSet' | translate}}
            } @else if (commonSettings?.Currencies?.Type==2) {
              {{'Bonuses.OutOfSet' | translate}}
            }
            </span>
        </div>

        <div class="form-field  group-field" [formGroupName]="'Currencies'">
          <div class="group-left-item">
            <input [value]="1" [formControlName]="'Type'" type="radio">{{'Bonuses.InSet' | translate}}
            <input [value]="2" style="margin-left: 5px;" [formControlName]="'Type'" type="radio">{{'Bonuses.OutOfSet' |
            translate}}
          </div>

          <div class="group-right-item">

            <mat-select [formControlName]="'Ids'" multiple>
              @for (currency of currencies; track $index) {
                <mat-option [value]="currency.Id">{{currency.Name}}</mat-option>
              }
            </mat-select>
          </div>
        </div>
      </div>


      <div></div>

      <div>
        <label
          style="padding: 10px; display: inline-flex; align-items: center; border-radius: 5px;border: 1px solid  blue; width: 110px; cursor: pointer"
          for="file">{{'Bonuses.ManualUpload' | translate}}</label>
        <div style="display: none">
          <input id="file" type="file" (change)="uploadFile($event)">
        </div>
      </div>

      <div class="types">
        @if(bonusTypeId === 12 || bonusTypeId === 13 ||bonusTypeId === 10) {
          <div class="additionally" >
            <mat-form-field>
              <mat-label>{{'Bonuses.SelectType' | translate}}</mat-label>
              <mat-select [(value)]="addedConditions.selectedGroupType"
                (selectionChange)="addedConditions.selectedGroupType = $event.value">
                @for (name of addedConditions.groupTypes; track $index) {
                  <mat-option [value]="name.Id">{{name.Name}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
  
            @for (condition of addedConditions.conditions; track $index) {
              <div  class="condition-list">
                <div>{{condition?.Condition?.Name}}</div>
                <div>{{condition?.ConditionType?.NickName}}</div>
                <div>{{condition?.ConditionValue}}</div>
                <mat-icon (click)="removeCondition(addedConditions, $index)">close</mat-icon>
              </div>
            }
            <div class="condition-action">
              <div class="selection-action">
                <mat-form-field>
                  <mat-label>{{'Bonuses.SelectCondition' | translate}}</mat-label>
                  <mat-select [ngModel]="addedConditions.selectedCondition"
                    (selectionChange)="addedConditions.selectedCondition = $event.value"
                    [ngModelOptions]="{standalone: true}">
                    @for (name of conditions; track $index) {
                      <mat-option [value]="name">{{name.Name}}</mat-option>
                    }
                  </mat-select>
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{'Bonuses.SelectOperation' | translate}}</mat-label>
                  <mat-select #selectedOperation [ngModel]="addedConditions.selectedConditionType"
                    (selectionChange)="addedConditions.selectedConditionType = selectedOperation.value"
                    [ngModelOptions]="{standalone: true}">
                    @for (name of conditionTypes; track $index) {
                      <mat-option [value]="name">{{name.NickName}}</mat-option>
                    }
                  </mat-select>
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{'Bonuses.Value' | translate}}</mat-label>
                  <input matInput type="text" [placeholder]="'Bonuses.Value' | translate"
                    [ngModel]="addedConditions.selectedConditionValue"
                    (ngModelChange)="this.addedConditions.selectedConditionValue = $event"
                    [ngModelOptions]="{standalone: true}">
                </mat-form-field>
              </div>
  
              <div class="btn-action">
                <button mat-stroked-button class="mat-btn" (click)="addCondition(addedConditions)"
                  [class.disabled]="!addedConditions.selectedCondition || !addedConditions.selectedConditionType || !this.addedConditions.selectedConditionValue">
                  {{'Common.Add' | translate}}
                </button>
                <button mat-stroked-button class="mat-btn" (click)="addGroup(addedConditions)">{{'Bonuses.AddGroup' |
                  translate}}</button>
              </div>
  
            </div>
  
            @for (group of addedConditions.groups; track $index) {
              <div class="group-container">
                <mat-form-field>
                  <mat-label>{{'Bonuses.SelectType' | translate}}</mat-label>
                  <mat-select [ngModel]="group.selectedGroupType" (selectionChange)="group.selectedGroupType = $event.value"
                    [ngModelOptions]="{standalone: true}">
                    @for (groupType of group.groupTypes; track $index) {
                      <mat-option
                        [value]="groupType.Id">{{groupType.Name}}</mat-option>
                    }
                  </mat-select>
                </mat-form-field>
                @for (condition of group.conditions; track condition) {
                  <div class="condition-list">
                    <div>{{condition.Condition.Name}}</div>
                    <div>{{condition.ConditionType.NickName}}</div>
                    <div>{{condition.ConditionValue}}</div>
                    <mat-icon (click)="removeCondition(group, $index)">close</mat-icon>
                  </div>
                }
    
                <div class="condition-action">
    
                  <div class="selection-action">
                    <mat-form-field>
                      <mat-label>{{'Bonuses.SelectCondition' | translate}}</mat-label>
                      <mat-select [ngModel]="group.selectedCondition"
                        (selectionChange)="group.selectedCondition = $event.value" [ngModelOptions]="{standalone: true}">
                        <mat-option value="" disabled>{{'Bonuses.SelectCondition' | translate}}</mat-option>
                        @for (condition of conditions; track $index) {
                          <mat-option [value]="condition">{{condition.Name}}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                      <mat-label>{{'Bonuses.SelectOperation' | translate}}</mat-label>
                      <mat-select [ngModel]="group.selectedConditionType"
                        (selectionChange)="group.selectedConditionType = $event.value"
                        [ngModelOptions]="{standalone: true}">
                        <mat-option value="" disabled>{{'Bonuses.SelectOperation' | translate}}</mat-option>
                        @for (conditionType of conditionTypes; track $index) {
                          <mat-option [value]="conditionType">{{conditionType.NickName}}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                      <input matInput [placeholder]="'Value'" [ngModel]="group.selectedConditionValue"
                        (ngModelChange)="group.selectedConditionValue = $event" [ngModelOptions]="{standalone: true}">
                    </mat-form-field>
    
                  </div>
    
                  <div class="btn-action">
                    <button mat-stroked-button class="mat-btn" (click)="addCondition(group)"
                      [class.disabled]="!group.selectedCondition || !group.selectedConditionType || !group.selectedConditionValue">{{'Common.Add'
                      | translate}}
                    </button>
                    <button mat-stroked-button class="mat-btn" (click)="addGroup(group)">{{'Bonuses.AddGroup' |
                      translate}}</button>
                    <button mat-stroked-button class="mat-btn"
                      (click)="removeGroup(addedConditions, $index)">{{'Bonuses.RemoveGroup' | translate}}</button>
                  </div>
                </div>

                @for (subgroup of group.groups; track $index) {
                  <div class="sub-group-container">
                    <mat-form-field>
                      <mat-label>Select</mat-label>
                      <mat-select [ngModel]="subgroup.selectedGroupType"
                        (selectionChange)="subgroup.selectedGroupType = $event.value" [ngModelOptions]="{standalone: true}">
                        @for (groupType of subgroup.groupTypes; track $index) {
                          <mat-option [value]="groupType.Id">{{groupType.Name}}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
      
                    @for (condition of subgroup.conditions; track $index) {
                      <div class="condition-list">
                        <div>{{condition.Condition.Name}}</div>
                        <div>{{condition.ConditionType.NickName}}</div>
                        <div>{{condition.ConditionValue}}</div>
                        <mat-icon style="cursor: pointer" (click)="removeCondition(subgroup, $index)">close</mat-icon>
                      </div>
                    }
      
                    <div class="condition-action">
                      <div class="selection-action sub-group">
                        <mat-form-field>
                          <mat-label>{{'Bonuses.SelectCondition' | translate}}</mat-label>
                          <mat-select [ngModel]="subgroup.selectedCondition"
                            (selectionChange)="subgroup.selectedCondition = $event.value"
                            [ngModelOptions]="{standalone: true}">
                            <mat-option value="" disabled>{{'Bonuses.SelectCondition' | translate}}</mat-option>
                            @for (condition of conditions; track $index) {
                              <mat-option [value]="condition">{{condition.Name}}</mat-option>
                            }
                          </mat-select>
                        </mat-form-field>
                        <mat-form-field>
                          <mat-label>{{'Bonuses.SelectOperation' | translate}}</mat-label>
                          <mat-select [ngModel]="subgroup.selectedConditionType"
                            (selectionChange)="subgroup.selectedConditionType = $event.value"
                            [ngModelOptions]="{standalone: true}">
                            <mat-option value="" disabled>{{'Bonuses.SelectOperation' | translate}}</mat-option>
                            @for (conditionType of conditionTypes; track $index) {
                              <mat-option [value]="conditionType">{{conditionType.NickName}}</mat-option>
                            }
                          </mat-select>
                        </mat-form-field>
                        <mat-form-field>
                          <input matInput [placeholder]="'Value'" [ngModel]="subgroup.selectedConditionValue"
                            (ngModelChange)="subgroup.selectedConditionValue = $event" [ngModelOptions]="{standalone: true}">
                        </mat-form-field>
                      </div>
                      <div class="btn-action">
                        <button mat-stroked-button class="mat-btn" (click)="addCondition(subgroup)"
                          [class.disabled]="!subgroup.selectedCondition || !subgroup.selectedConditionType || !subgroup.selectedConditionValue">{{'Common.Add'
                          | translate}}
                        </button>
                        <button mat-stroked-button class="mat-btn" (click)="removeGroup(group, $index)">{{'Bonuses.RemoveGroup' |
                          translate}}</button>
                      </div>
                    </div>
                  </div>
                }
              </div>
            }
          </div>
        }
      </div>

      <div class="form-actions">
        @if (isEdit) {
          <div class="actions">
            <button mat-raised-button class="mat-cancel-btn" (click)="this.isEdit = false;">{{'Cancel' |
              translate}}</button>
            <button mat-raised-button class="mat-btn" type="submit" (click)="onSubmit()">{{'Save' | translate}}</button>
          </div>
        }
      </div>
    </form>
  </div>

  <br>

  <div class="mat-table">
    <div class="content-action">
      <div class="title">{{'Bonuses.BonusCurrencySettings' | translate}}</div>
      <button mat-stroked-button class="mat-btn" (click)="onOpenCurrencySettings()">{{'Partners.AddCurrencySettings' |
        translate}}</button>
    </div>

    <app-currency-settings-component [dataSource]="this.commonSettings?.AmountSettings" [isNotUptoAmmount]="true"
      (dataSourceChange)="onAmmountSettingsChange($event)"></app-currency-settings-component>
  </div>

  <div class="content-action">
    <div class="title">{{'Common.History' | translate}}</div>
  </div>

  <div class="grid-content" >
    <ag-grid-angular 
      #agGrid class="ag-theme-balham" 
      [headerHeight]="33" 
      [suppressCopyRowsToClipboard]="true"
      [rowHeight]="42" 
      [rowData]="rowData" 
      [rowModelType]="rowModelType" 
      [columnDefs]="columnDefs"
      [defaultColDef]="defaultColDef" 
      [cacheBlockSize]="cacheBlockSize"
      (gridReady)="onGridReady($event)" 
      [ensureDomOrder]="true" 
      [enableCellTextSelection]="true"
      [getContextMenuItems]="getContextMenuItems" 
      rowSelection="single">
    </ag-grid-angular>
  </div>

</div>